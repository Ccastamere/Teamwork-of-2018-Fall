# Storage(Ceph)
> Ceph: A Scalable, High-Performance Distributed File System

## Features 
- 核心设计思想：
  - Ceph通过用一个伪随机数据分布函数(CRUSH)替代分布表来最大化的分离数据与元数据管理，
  - Ceph利用高度自适应分布式元数据集群,显著提高元数据访问的可扩展性,通过它也提高整个系统的可扩展性。
- 系统设计概览
  - 三个主要组件：
    - 客户端：暴露near-POSIX的文件系统接口给主机或进程
    - OSD集群：存储所有数据和元数据
    - 元数据服务器集群：管理名空间(文件名和目录),协调安全与一致性

  ![img1](img1.png)
  - 三个基本设计：
    - 分离数据和元数据
      - Ceph中完全消除分配列表的设计
      - 文件数据条带化到可计算的命名对象
      - 通过一个**数据分布函数CRUSH**将这些对象分配给存储设备
        - Ceph首先通过简单哈希算法将对象映射到放置组(PGs)，然后通过CRUSH算法将放置组分配到所有OSD。
        - 这个算法是一个伪随机数据分布算法， 能够有效地将每个PG映射到一个用来存储对象副本的有序OSD序列
        - 数据放置不依赖任何的块或对象列表元数据。为了定位每个对象， CRUSH只需要放置组和OSD的cluster map

  ![img3](img3.png)
    - 动态分布式元数据管理
      - 采用基于**动态子树划分**的新型元数据集群结构
        - 通过使用计数器统计每个MDS中元数据的访问量。

      ![img2](img2.png)

      - 它能够适应性智能化地分配职责，可在十个甚至上百个MDS上管理文件系统目录结构。
      - 一个动态的层次分明的分区在每个MDS工作负载中被保留位置，可促进有效更新和预取
      - 元数据服务器的负载分布是基于当前的访问状态，使Ceph能在任何工作负载之下有效的利用当前的MDS资源，获得近似线性扩展性能。
    - 可靠的自动分布的对象存储 RADOS
      - Ceph承担着对存储数据的OSD集群进行数据迁移，备份，故障检测，故障修复的责任
      - OSD可给客户端和元数据服务器提供独立的逻辑对象存储,使得Ceph能更加有效的利用计算资源处理能力(CPU和内存),使每个OSD实现可靠、高可用性的线性扩展性能的对象存储
- 客户端操作
- 动态分布式元数据

文件和目录元数据在Ceph中很小,几乎完全由目录入口(文件名)和inode(80字节)组成。与传统的文件系统不同, Ceph中不需要文件分布元数据，对象名称使用inode号， 并通过CRUSH算法分布到OSD。这简化了元数据的工作负载, 并允许MDS有效管理一个非常大的文件集合（不考虑文件大小）。我们的设计通过使用一个双向的存储策略,和通过动态子树分区最大化的本地化和缓存效率进一步减少元数据相关的磁盘I / O。
  - 动态子树划分
    
  -
- 分布式对象存储
  - CRUSH算法进行数据映射
    
   
## Pros & Cons
### Pros
- 本质上，Ceph的这些优势均来源于其先进的核心设计思想，有人将其概括为八个字——“无需查表，算算就好”。基于这种设计思想，Ceph充分发挥存储设备自身的计算能力，同时消除了对系统单一中心节点的依赖，从而实现了真正的无中心结构。基于这一设计思想和结构，Ceph一方面实现了高度的可靠性和可扩展性，另一方面保证了客户端访问的相对低延迟和高聚合带宽。
- 在这个核心设计思想的指导下，Ceph 有许多优秀特性，包括统一存储能力、可扩展性、可靠性、性能、自动化的维护等等。